<!doctype html>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title data-i18n="contact.title">Contacto — RedVelvetLive</title>
  <meta name="description" content="Ponte en contacto con el equipo de RedVelvetLive: soporte, abuso/seguridad y DMCA." data-i18n="contact.description">
  <link rel="canonical" href="https://www.redvelvetlive.com/contact.html">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
  <div data-include="header"></div>
  <main class="main-container">
    <section class="panel fade-in" aria-labelledby="contactTitle">
      <div class="panel-header">
        <h1 id="contactTitle" data-i18n="contact.heading">Contáctanos</h1>
        <p class="muted" data-i18n="contact.responseTime">Tiempo de respuesta habitual: 24–48 h laborales.</p>
      </div>
      <div class="grid grid-2" style="--grid-min:320px">
        <aside class="card">
          <h3 data-i18n="contact.support">Soporte general</h3>
          <p><a href="mailto:soporte@redvelvetlive.com">soporte@redvelvetlive.com</a></p>
          <h3 data-i18n="contact.abuse">Abuso / seguridad</h3>
          <p><a href="mailto:abuse@redvelvetlive.com">abuse@redvelvetlive.com</a></p>
          <h3 data-i18n="contact.dmca">DMCA</h3>
          <p><a href="mailto:dmca@redvelvetlive.com">dmca@redvelvetlive.com</a></p>
          <div class="muted" style="margin-top:12px">
            <small data-i18n="contact.note">Para asuntos urgentes de seguridad, indica enlaces, IDs y capturas. No compartas contraseñas.</small>
          </div>
        </aside>
        <section class="card" aria-labelledby="formTitle">
          <h2 id="formTitle" style="margin-bottom:6px" data-i18n="contact.formTitle">Formulario</h2>
          <p class="muted" style="margin-top:0" data-i18n="contact.formIntro">Completa los campos y te responderemos por correo.</p>
          <form id="contactForm" class="grid" style="gap:12px" novalidate>
            <input type="text" name="_hp" id="hp" tabindex="-1" autocomplete="off" style="position:absolute;left:-9999px;opacity:0" aria-hidden="true">
            <label class="sr-only" for="name" data-i18n="contact.name">Nombre</label>
            <input id="name" name="name" placeholder="Nombre" required minlength="2" maxlength="80" autocomplete="name" />
            <label class="sr-only" for="email" data-i18n="contact.email">Correo</label>
            <input id="email" name="email" type="email" placeholder="Correo" required autocomplete="email" inputmode="email"/>
            <label class="sr-only" for="topic" data-i18n="contact.topic">Tema</label>
            <select id="topic" name="topic" required>
              <option value="" data-i18n="contact.topicSelect">Selecciona un tema…</option>
              <option value="support" data-i18n="contact.optionSupport">Soporte</option>
              <option value="security" data-i18n="contact.optionSecurity">Abuso / seguridad</option>
              <option value="dmca" data-i18n="contact.optionDMCA">DMCA</option>
              <option value="other" data-i18n="contact.optionOther">Otro</option>
            </select>
            <label class="sr-only" for="message" data-i18n="contact.message">Mensaje</label>
            <textarea id="message" name="message" rows="6" placeholder="Mensaje" required minlength="10" maxlength="2000"></textarea>
            <div class="muted" style="display:flex;gap:8px;align-items:center">
              <input id="consent" name="consent" type="checkbox" required style="margin:0">
              <label for="consent" style="margin:0" data-i18n="contact.consent">Acepto que me contacten respecto a esta solicitud.</label>
            </div>
            <button id="sendBtn" class="btn" type="submit" data-i18n="contact.send">Enviar</button>
            <div id="formAlert" role="status" aria-live="polite" class="muted" style="display:none"></div>
            <noscript>
              <p class="muted" data-i18n="contact.noscript">
                Si el formulario no funciona en tu navegador, escríbenos a <a href="mailto:soporte@redvelvetlive.com?subject=Contacto%20RedVelvetLive">soporte@redvelvetlive.com</a>.
              </p>
            </noscript>
          </form>
        </section>
      </div>
    </section>
  </main>
  <div data-include="cookies"></div>
  <div data-include="footer"></div>

  <!-- ✅ Mejorado: soporte import.meta.env -->
  <script>
    window.API_BASE  = window.API_BASE  || import.meta.env?.VITE_API_BASE  || '/api';
    window.AUTH_BASE = window.AUTH_BASE || import.meta.env?.VITE_AUTH_BASE || '/auth';
  </script>

  <script src="/js/includes.js" defer></script>
  <script src="/js/navigation.js" defer></script>
  <script src="/js/theme-switcher.js" defer></script>
  <script src="/js/i18n.js" defer></script>

  <script>
    (function () {
      const $ = (s,r=document)=>r.querySelector(s);
      const form   = $('#contactForm');
      const alertB = $('#formAlert');
      const btn    = $('#sendBtn');

      function show(msg, ok=false){ 
        alertB.textContent = msg; 
        alertB.style.display = ''; 
        alertB.classList.toggle('ok', ok); 
      }
      function clearMsg(){ 
        alertB.style.display='none'; 
        alertB.textContent=''; 
      }
      function validEmail(v){ 
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||''); 
      }

      async function send(payload){
        if (window.CONTACT_ENDPOINT){
          return fetch(window.CONTACT_ENDPOINT, {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify(payload)
          });
        }
        const url = (window.API_BASE||'/api') + '/contact';
        return fetch(url, {
          method:'POST',
          credentials:'include',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });
      }

      form?.addEventListener('submit', async (e)=>{
        e.preventDefault(); clearMsg();
        if ($('#hp').value.trim()){ return; }
        const name = $('#name').value.trim();
        const email = $('#email').value.trim();
        const topic = $('#topic').value;
        const message = $('#message').value.trim();
        const consent = $('#consent').checked;
        if (name.length<2){ show('Indica tu nombre.'); return; }
        if (!validEmail(email)){ show('Escribe un correo válido.'); return; }
        if (!topic){ show('Selecciona un tema.'); return; }
        if (message.length<10){ show('El mensaje es demasiado corto.'); return; }
        if (!consent){ show('Debes aceptar el consentimiento.'); return; }

        btn.disabled = true; 
        btn.classList.add('loading'); 
        show('Enviando…');

        try{
          const res = await send({name,email,topic,message,consent});
          if (!res.ok) throw new Error('Error ' + res.status);
          show('¡Recibido! Te escribiremos pronto. ✅', true);
          form.reset();
        }catch(err){
          console.warn(err);
          show('No pudimos enviar el formulario. Intenta de nuevo o escribe a soporte@redvelvetlive.com');
        }finally{
          btn.disabled = false; 
          btn.classList.remove('loading');
        }
      });
    })();
  </script>

  <style>
    #formAlert.ok{ color: var(--ok, #0a7); }
    .btn.loading { opacity:.7; pointer-events:none }
    .sr-only{ 
      position:absolute !important; 
      width:1px; 
      height:1px; 
      padding:0; 
      margin:-1px; 
      overflow:hidden; 
      clip:rect(0,0,0,0); 
      white-space:nowrap; 
      border:0; 
    }
  </style>
</body>
</html>
